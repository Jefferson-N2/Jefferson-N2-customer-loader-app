{
	"info": {
		"_postman_id": "customer-loader-api-tests",
		"name": "Customer Loader API - Test Collection",
		"description": "Colección completa para probar todos los endpoints del sistema de carga masiva de clientes",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"variable": [
		{
			"key": "baseUrl",
			"value": "http://localhost:8080/customer-bulk-loader",
			"type": "string"
		},
		{
			"key": "processId",
			"value": "",
			"type": "string"
		},
		{
			"key": "clientCode",
			"value": "",
			"type": "string"
		},
		{
			"key": "accountNumber",
			"value": "",
			"type": "string"
		}
	],
	"item": [
		{
			"name": "Health Checks",
			"item": [
				{
					"name": "Health Check",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/health",
							"host": ["{{baseUrl}}"],
							"path": ["health"]
						}
					},
					"response": []
				},
				{
					"name": "Readiness Check",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/health/ready",
							"host": ["{{baseUrl}}"],
							"path": ["health", "ready"]
						}
					},
					"response": []
				},
				{
					"name": "Liveness Check",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/health/live",
							"host": ["{{baseUrl}}"],
							"path": ["health", "live"]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "Bulk Load - Casos Válidos",
			"item": [
				{
					"name": "Cargar Archivo Válido",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code is 200', function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test('Response has processId', function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.processId).to.exist;",
									"    pm.collectionVariables.set('processId', jsonData.processId);",
									"});",
									"",
									"pm.test('Status is COMPLETED', function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.status).to.eql('COMPLETED');",
									"});"
								]
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "text/plain"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "Tipo ID|Numero ID|Fecha Ingreso|Valor Nomina|Email|Telefono\nC|12345678|2024-01-15|50000.00|juan.perez@empresa.com|3125551234\nP|AB123456|2024-02-01|75000.50|maria.garcia@empresa.com|3185559876"
						},
						"url": {
							"raw": "{{baseUrl}}/bulk-load/clients?fileName=clientes_validos.txt",
							"host": ["{{baseUrl}}"],
							"path": ["bulk-load", "clients"],
							"query": [
								{
									"key": "fileName",
									"value": "clientes_validos.txt"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "Cargar Archivo con Pasaportes",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "text/plain"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "Tipo ID|Numero ID|Fecha Ingreso|Valor Nomina|Email|Telefono\nP|XY987654|2024-03-01|60000.00|carlos.lopez@empresa.com|3001234567\nP|ZW456789|2024-03-15|55000.00|ana.martinez@empresa.com|3209876543"
						},
						"url": {
							"raw": "{{baseUrl}}/bulk-load/clients?fileName=pasaportes_validos.txt",
							"host": ["{{baseUrl}}"],
							"path": ["bulk-load", "clients"],
							"query": [
								{
									"key": "fileName",
									"value": "pasaportes_validos.txt"
								}
							]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "Bulk Load - Casos de Error",
			"item": [
				{
					"name": "Archivo sin Nombre",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code is 400', function () {",
									"    pm.response.to.have.status(400);",
									"});"
								]
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "text/plain"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "C|12345678|2024-01-15|50000.00|test@email.com|3125551234"
						},
						"url": {
							"raw": "{{baseUrl}}/bulk-load/clients",
							"host": ["{{baseUrl}}"],
							"path": ["bulk-load", "clients"]
						}
					},
					"response": []
				},
				{
					"name": "Tipos de ID Inválidos",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "text/plain"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "Tipo ID|Numero ID|Fecha Ingreso|Valor Nomina|Email|Telefono\nX|12345678|2024-01-15|50000.00|test@email.com|3125551234\nV|87654321|2024-02-01|60000.00|test2@email.com|3185559876\nE|11223344|2024-03-01|45000.00|test3@email.com|3001234567"
						},
						"url": {
							"raw": "{{baseUrl}}/bulk-load/clients?fileName=tipos_id_invalidos.txt",
							"host": ["{{baseUrl}}"],
							"path": ["bulk-load", "clients"],
							"query": [
								{
									"key": "fileName",
									"value": "tipos_id_invalidos.txt"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "Fechas Inválidas",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "text/plain"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "Tipo ID|Numero ID|Fecha Ingreso|Valor Nomina|Email|Telefono\nC|12345678|15/01/2024|50000.00|test@email.com|3125551234\nC|87654321|2024-13-01|60000.00|test2@email.com|3185559876\nC|11223344|2024-02-30|45000.00|test3@email.com|3001234567"
						},
						"url": {
							"raw": "{{baseUrl}}/bulk-load/clients?fileName=fechas_invalidas.txt",
							"host": ["{{baseUrl}}"],
							"path": ["bulk-load", "clients"],
							"query": [
								{
									"key": "fileName",
									"value": "fechas_invalidas.txt"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "Emails Inválidos",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "text/plain"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "Tipo ID|Numero ID|Fecha Ingreso|Valor Nomina|Email|Telefono\nC|12345678|2024-01-15|50000.00|email-invalido|3125551234\nC|87654321|2024-02-01|60000.00|@domain.com|3185559876\nC|11223344|2024-03-01|45000.00|user@|3001234567"
						},
						"url": {
							"raw": "{{baseUrl}}/bulk-load/clients?fileName=emails_invalidos.txt",
							"host": ["{{baseUrl}}"],
							"path": ["bulk-load", "clients"],
							"query": [
								{
									"key": "fileName",
									"value": "emails_invalidos.txt"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "Teléfonos Inválidos",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "text/plain"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "Tipo ID|Numero ID|Fecha Ingreso|Valor Nomina|Email|Telefono\nC|12345678|2024-01-15|50000.00|test@email.com|123\nC|87654321|2024-02-01|60000.00|test2@email.com|12345678901\nC|11223344|2024-03-01|45000.00|test3@email.com|312-555-1234"
						},
						"url": {
							"raw": "{{baseUrl}}/bulk-load/clients?fileName=telefonos_invalidos.txt",
							"host": ["{{baseUrl}}"],
							"path": ["bulk-load", "clients"],
							"query": [
								{
									"key": "fileName",
									"value": "telefonos_invalidos.txt"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "Valores de Nómina Inválidos",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "text/plain"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "Tipo ID|Numero ID|Fecha Ingreso|Valor Nomina|Email|Telefono\nC|12345678|2024-01-15|cincuenta mil|test@email.com|3125551234\nC|87654321|2024-02-01|$60000|test2@email.com|3185559876\nC|11223344|2024-03-01|texto|test3@email.com|3001234567"
						},
						"url": {
							"raw": "{{baseUrl}}/bulk-load/clients?fileName=nomina_invalida.txt",
							"host": ["{{baseUrl}}"],
							"path": ["bulk-load", "clients"],
							"query": [
								{
									"key": "fileName",
									"value": "nomina_invalida.txt"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "Archivo Incompleto",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "text/plain"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "Tipo ID|Numero ID|Fecha Ingreso|Valor Nomina|Email|Telefono\nC|12345678|2024-01-15\nC|87654321|2024-02-01|60000.00\nC|11223344"
						},
						"url": {
							"raw": "{{baseUrl}}/bulk-load/clients?fileName=archivo_incompleto.txt",
							"host": ["{{baseUrl}}"],
							"path": ["bulk-load", "clients"],
							"query": [
								{
									"key": "fileName",
									"value": "archivo_incompleto.txt"
								}
							]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "Consultas de Clientes",
			"item": [
				{
					"name": "Listar Clientes por Proceso",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code is 200', function () {",
									"    pm.response.to.have.status(200);",
									"});",
									"",
									"pm.test('Response has clients array', function () {",
									"    var jsonData = pm.response.json();",
									"    pm.expect(jsonData.clients).to.be.an('array');",
									"    if (jsonData.clients.length > 0) {",
									"        pm.collectionVariables.set('clientCode', jsonData.clients[0].clientCode);",
									"        pm.collectionVariables.set('accountNumber', jsonData.clients[0].account.accountNumber);",
									"    }",
									"});"
								]
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/bulk-load/clients/{{processId}}/clients?page=0&size=20",
							"host": ["{{baseUrl}}"],
							"path": ["bulk-load", "clients", "{{processId}}", "clients"],
							"query": [
								{
									"key": "page",
									"value": "0"
								},
								{
									"key": "size",
									"value": "20"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "Detalle de Cliente Específico",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/bulk-load/clients/{{processId}}/clients/{{clientCode}}",
							"host": ["{{baseUrl}}"],
							"path": ["bulk-load", "clients", "{{processId}}", "clients", "{{clientCode}}"]
						}
					},
					"response": []
				},
				{
					"name": "Cliente No Encontrado",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code is 404', function () {",
									"    pm.response.to.have.status(404);",
									"});"
								]
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/bulk-load/clients/{{processId}}/clients/CLI-INEXISTENTE",
							"host": ["{{baseUrl}}"],
							"path": ["bulk-load", "clients", "{{processId}}", "clients", "CLI-INEXISTENTE"]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "Consultas de Errores",
			"item": [
				{
					"name": "Errores por Cliente",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/bulk-load/clients/{{processId}}/clients/{{clientCode}}/errors",
							"host": ["{{baseUrl}}"],
							"path": ["bulk-load", "clients", "{{processId}}", "clients", "{{clientCode}}", "errors"]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "Consultas de Pagos",
			"item": [
				{
					"name": "Historial de Pagos",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/accounts/{{accountNumber}}/payments?page=0&size=20",
							"host": ["{{baseUrl}}"],
							"path": ["accounts", "{{accountNumber}}", "payments"],
							"query": [
								{
									"key": "page",
									"value": "0"
								},
								{
									"key": "size",
									"value": "20"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "Cuenta No Encontrada",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test('Status code is 404', function () {",
									"    pm.response.to.have.status(404);",
									"});"
								]
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/accounts/ACC-INEXISTENTE/payments",
							"host": ["{{baseUrl}}"],
							"path": ["accounts", "ACC-INEXISTENTE", "payments"]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "Casos Extremos",
			"item": [
				{
					"name": "Archivo Muy Grande (Simulado)",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "text/plain"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "Tipo ID|Numero ID|Fecha Ingreso|Valor Nomina|Email|Telefono\nC|10000001|2024-01-15|50000.00|user1@empresa.com|3125551001\nC|10000002|2024-01-15|50000.00|user2@empresa.com|3125551002\nC|10000003|2024-01-15|50000.00|user3@empresa.com|3125551003\nC|10000004|2024-01-15|50000.00|user4@empresa.com|3125551004\nC|10000005|2024-01-15|50000.00|user5@empresa.com|3125551005"
						},
						"url": {
							"raw": "{{baseUrl}}/bulk-load/clients?fileName=archivo_grande.txt",
							"host": ["{{baseUrl}}"],
							"path": ["bulk-load", "clients"],
							"query": [
								{
									"key": "fileName",
									"value": "archivo_grande.txt"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "Caracteres Especiales en Nombres",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "text/plain"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "Tipo ID|Numero ID|Fecha Ingreso|Valor Nomina|Email|Telefono\nC|20000001|2024-01-15|50000.00|jose.maria@empresa.com|3125551234\nP|AB20001|2024-02-01|75000.50|maría.josé@empresa.com|3185559876"
						},
						"url": {
							"raw": "{{baseUrl}}/bulk-load/clients?fileName=caracteres_especiales.txt",
							"host": ["{{baseUrl}}"],
							"path": ["bulk-load", "clients"],
							"query": [
								{
									"key": "fileName",
									"value": "caracteres_especiales.txt"
								}
							]
						}
					},
					"response": []
				},
				{
					"name": "Paginación Límites",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/bulk-load/clients/{{processId}}/clients?page=999&size=1",
							"host": ["{{baseUrl}}"],
							"path": ["bulk-load", "clients", "{{processId}}", "clients"],
							"query": [
								{
									"key": "page",
									"value": "999"
								},
								{
									"key": "size",
									"value": "1"
								}
							]
						}
					},
					"response": []
				}
			]
		}
	]
}