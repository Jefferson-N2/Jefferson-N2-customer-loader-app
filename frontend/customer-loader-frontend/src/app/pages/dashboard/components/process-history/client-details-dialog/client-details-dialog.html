<div class="dialog-header">
  <h2>Detalles del Cliente</h2>
</div>

<div class="dialog-content">
  <!-- Contenido -->
  <ng-container *ngIf="clientDetails$ | async as client">
    <!-- Información Personal -->
    <mat-card class="info-card">
      <mat-card-header>
        <mat-card-title>Información Personal</mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <div class="info-grid">
          <div class="info-item">
            <span class="label">Código Cliente</span>
            <span class="value">{{ client.clientCode }}</span>
          </div>
          <div class="info-item">
            <span class="label">Identificación</span>
            <span class="value">{{ client.idType }} - {{ client.idNumber }}</span>
          </div>
          <div class="info-item">
            <span class="label">Nombres</span>
            <span class="value">{{ client.firstName }}</span>
          </div>
          <div class="info-item">
            <span class="label">Apellidos</span>
            <span class="value">{{ client.lastName }}</span>
          </div>
          <div class="info-item">
            <span class="label">Fecha Nacimiento</span>
            <span class="value">{{ formatDate(client.birthDate) }}</span>
          </div>
          <div class="info-item">
            <span class="label">Fecha de Vinculación</span>
            <span class="value">{{ formatDate(client.joinDate) }}</span>
          </div>
          <div class="info-item">
            <span class="label">Email</span>
            <span class="value">
              <a [href]="'mailto:' + client.email">{{ client.email }}</a>
            </span>
          </div>
          <div class="info-item">
            <span class="label">Teléfono</span>
            <span class="value">{{ client.phoneNumber }}</span>
          </div>
        </div>
      </mat-card-content>
    </mat-card>

    <!-- Información de Cuenta -->
    <mat-card class="account-card" *ngIf="(account$ | async) as account">
      <mat-card-header>
        <mat-card-title>Información de Cuenta</mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <div class="account-grid">
          <div class="account-item">
            <span class="label">Número de Cuenta</span>
            <span class="value account-number">{{ account.accountNumber }}</span>
          </div>
          <div class="account-item">
            <span class="label">Estado Cuenta</span>
            <span
              class="status-badge"
              [ngClass]="'status-' + (account.status?.toLowerCase() || 'unknown')"
            >
              {{ account.status }}
            </span>
          </div>
          <div class="account-item full-width">
            <span class="label">Valor de Nómina</span>
            <span class="value payroll-value">
              {{ formatCurrency(account.payrollValue) }}
            </span>
          </div>
        </div>
      </mat-card-content>
    </mat-card>

    <!-- Historial de Pagos -->
    <mat-card class="payments-card">
      <mat-card-header>
        <mat-card-title>Primer Pago</mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <div *ngIf="(firstPayment$ | async) as payment; else noPayment" class="payment-details">
          <div class="payment-item">
            <span class="label">Fecha de Pago</span>
            <span class="value">{{ formatDate(payment.paymentDate) }}</span>
          </div>
          <div class="payment-item">
            <span class="label">Monto</span>
            <span class="value">{{ formatCurrency(payment.amount) }}</span>
          </div>
          <div class="payment-item">
            <span class="label">Estado</span>
            <span class="status-badge" [ngClass]="'status-' + (payment.status?.toLowerCase() || 'unknown')">
              {{ payment.status || 'N/A' }}
            </span>
          </div>
        </div>
        <ng-template #noPayment>
          <p class="no-data">No hay información de pago disponible</p>
        </ng-template>
      </mat-card-content>
    </mat-card>
  </ng-container>

  <!-- Error -->
  <div class="error" *ngIf="error$ | async as error" role="alert">
    <mat-icon>error</mat-icon>
    <p>{{ error }}</p>
  </div>
</div>

<div class="dialog-actions">
  <button mat-button mat-dialog-close aria-label="Cerrar diálogo">
    Cerrar
  </button>
</div>
